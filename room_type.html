<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title  -->
    <title>原森林 - 房型</title>

    <!-- Favicon  -->
    <link rel="icon" href="img/core-img/favicon.svg">

    <!-- Style CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

    <!-- Google Visualization js -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>

</head>

<body>
    <!-- Preloader -->
    <div id="preloader">
        <div class="preload-content">
            <div id="sonar-load"></div>
        </div>
    </div>

    <!-- ***** Main Menu Area ***** -->
    <div class="mainMenu d-flex align-items-center justify-content-between">
        <!-- Close Icon -->
        <div class="closeIcon">
            <i class="ti-close" aria-hidden="true"></i>
        </div>
        <!-- Logo Area -->
        <div class="logo-area">
            <a href="index.html">原森林</a>
        </div>
        <!-- Nav -->
        <div class="sonarNav wow fadeInUp" data-wow-delay="1s">
            <nav>
                <ul>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">首頁</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="room.html">房型介紹</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="recommendatoin.html">推薦行程</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="traffic.html">交通資訊</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="book.html">立即訂房</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="http://www.sunmoonlake.com.tw/index.html" target="blank">日月潭．原森林官網</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <!-- ***** Navbar ***** -->
    <header class="header-area">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="menu-area d-flex justify-content-between">
                        <!-- Logo Area  -->
                        <div class="logo-area">
                            <a href="index.html">日月潭．原森林&nbsp;<span class="fs-15px">練習網站</span></a>
                        </div>

                        <div class="menu-content-area d-flex align-items-center">
                            <!-- Header Social Area -->
                            <div class="header-social-area d-flex align-items-center">
                                <a href="https://www.facebook.com/yuanhomestay/" data-toggle="tooltip" data-placement="bottom" title="Facebook" target="blank"><i class="bi bi-facebook" aria-hidden="true"></i></a>
                                <a href="https://www.instagram.com/yuan_forest/?utm_medium=copy_link" data-toggle="tooltip" data-placement="bottom" title="Instagram" target="blank"><i class="bi bi-instagram" aria-hidden="true"></i></a>
                                <a href="mailto:yuanhomestay@gmail.com" data-toggle="tooltip" data-placement="bottom" title="Mail"><i class="bi bi-envelope-fill" aria-hidden="true"></i></a>
                                <a href="tel:0978896107" data-toggle="tooltip" data-placement="bottom" title="Telephone"><i class="bi bi-telephone-fill" aria-hidden="true"></i></a>
                            </div>
                            <!-- Menu Icon -->
                            <span class="navbar-toggler-icon" id="menuIcon"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ***** Room Content ***** -->
    <div class="hero-area d-flex align-items-center">
        <!-- Introduction -->
        <div class="bg-overlay d-table">
            <div class="container-fluid d-table-cell align-middle">
                <div class="row align-items-center justify-content-center">
                    <div class="col-6 px-5">
                        <div class="line mt-5 mb-2 sm-vanish"></div>
                        <h2 class="fs-30px fs-sm-20px mb-sm-05em" id="room-0">
                            <!-- Room Type by js -->
                        </h2>
                        <p class="mb-sm-02em" id="room-1">
                            <!-- Description by js -->
                        </p>
                        <p class="room-price text-end mb-sm-02em" id="room-234">
                            <!-- Price by js -->
                        </p>
                        <p class="text-white-75 text-end pr-20" id="room-5">
                            <!-- Extra-bed by js -->
                        </p>
                        <p class="text-white-75 fs-10px" id="room-6">
                            <!-- Facility by js -->
                        </p>
                    </div>
                    <div class="col-6">
                        <div id="room-slider" class="carousel slide mt-5 w-100" data-ride='carousel' data-interval="3000">
                            <ol class="carousel-indicators" id="room-7">
                                <!-- Slider Indicators by js -->
                            </ol>
                            <div class="carousel-inner" id="room-78">
                                <!-- Slider Images by js -->
                            </div>
                        </div>
                    </div>
                    <a href="room.html" data-placement="top" title="回到房型介紹"><i class="bi bi-arrow-up-left-circle-fill text-white fs-25px room-backpage"></i></a>
                    <a href="book.html" data-placement="top" title="前往訂票"><i class="bi bi-plus-circle-fill room-bookpage"></i></a>
                </div>
            </div>
        </div>
    </div>

    <!-- jQuery (Necessary for All JavaScript Plugins) -->
    <script src="js/jquery/jquery-2.2.4.min.js"></script>
    <!-- Popper js -->
    <script src="js/popper.min.js"></script>
    <!-- Bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- Plugins js -->
    <script src="js/plugins.js"></script>
    <!-- Active js -->
    <script src="js/active.js"></script>
    <!-- Map SpreadSheets -->
    <script>
        searchformresponse();

        function GetUrlVar(VarName) {
            name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
            var regexS = "[\\?&]" + VarName + "=([^&#]*)";
            var regex = new RegExp(regexS);
            var results = regex.exec(window.location.href);
            if (results == null)
                return "";
            else
                return results[1];
        }

        function searchformresponse() {
            google.charts.load('current', {
                'packages': ['corechart']
            });
            google.charts.setOnLoadCallback(init);

            function init() {
                var url = 'https://docs.google.com/spreadsheets/d/1QTmAMc2Jqv1WCMpDlpzYeu6ekMVi4VjyyRQQrhV-EQw/gviz/tq?sheet=Project-room';
                var query = new google.visualization.Query(url);
                query.setQuery('select *');
                query.send(processSheetsData);
            }
        }

        function processSheetsData(response) {
            if (response.isError()) {
                alert(response.getMessage() + '' + response.getDetailedMessage());
                return false;
            }
            var data = response.getDataTable();

            var X = decodeURIComponent(GetUrlVar('id'));
            var i = Number(X);
            var pic_n = Number(data.getFormattedValue(i, 7));

            var pagetitle = '原森林 - ' + data.getFormattedValue(i, 0)
            var room234 = '原價/國定假日｜' + data.getFormattedValue(i, 2) + '<br>寒暑假平日｜' + data.getFormattedValue(i, 3) + '<br>平日｜' + data.getFormattedValue(i, 4);
            var room6 = '設施： <br>' + data.getFormattedValue(i, 6);
            var room7 = assignroom7(pic_n);
            var room78 = assignroom78(pic_n, data.getFormattedValue(i, 8));

            document.getElementById('room-0').innerHTML = data.getFormattedValue(i, 0);
            document.getElementById('room-1').innerHTML = data.getFormattedValue(i, 1);
            document.getElementById('room-234').innerHTML = room234;
            document.getElementById('room-5').innerHTML = data.getFormattedValue(i, 5);
            document.getElementById('room-6').innerHTML = room6;
            document.getElementById('room-7').innerHTML = room7;
            document.getElementById('room-78').innerHTML = room78;
            document.title = pagetitle;
        }

        function assignroom7(n) {
            str = '<li data-target="#room-slider" data-slide-to="0" class="active"></li>'
            for (i = 1; i <= n; i++) {
                str += '<li data-target="#room-slider" data-slide-to="' + i + '"></li>';
            }
            return str;
        }

        function assignroom78(n, room_type) {
            str = '<div class="carousel-item active"><a class="gallery-img" href="img/room-img/' + room_type + '/' + room_type + '0.jpg"><img src="img/room-img/' + room_type + '/' + room_type + '0.jpg" class="d-block w-100"></a></div>';
            for (i = 1; i <= n; i++) {
                str += '<div class="carousel-item"><a class="gallery-img" href="img/room-img/' + room_type + '/' + room_type + i + '.jpg"><img src="img/room-img/' + room_type + '/' + room_type + i + '.jpg" class="d-block w-100"></a></div>';
            }
            return str;
        }
    </script>

</body>

</html>